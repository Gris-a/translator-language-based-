extern printf
extern scanf

global printsd
global scansd
global sqrrtsd

section     .text

; ===============================================
printsd:
; -----------------------------------------------
    push rbp
    mov rbp, rsp
; -----------------------------------------------
    shr rsp, 4
    shl rsp, 4
; -----------------------------------------------
    mov eax, 1
    mov rdi, print_format
    movsd xmm0, [rbp + 16]
; -----------------------------------------------
    call printf
; -----------------------------------------------
    mov rsp, rbp
    pop rbp
; -----------------------------------------------
    ret
; ===============================================

; ===============================================
scansd:
; -----------------------------------------------
    push rbp
    mov rbp, rsp
; -----------------------------------------------
    shr rsp, 4
    shl rsp, 4
; -----------------------------------------------
    sub rsp, 16
    mov rdi, scan_format
    mov rsi, rsp
; -----------------------------------------------
    call scanf
    pop rax
; -----------------------------------------------
    mov rsp, rbp
    pop rbp
; -----------------------------------------------
    ret
; ===============================================

; ===============================================
sqrrtsd:
; -----------------------------------------------
    sqrtsd xmm0, xmm0
    movq rax, xmm0
; -----------------------------------------------
    ret
; ===============================================

section     .rodata

scan_format db "%lg", 0x00
print_format db "%lg", 0x0a, 0x0d, 0x00